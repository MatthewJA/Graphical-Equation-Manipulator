/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,n){"function"==typeof define&&define.amd?define(n):t.libGlobalName=n()}(this,function(){var t,n,e;return function(i){function r(t,n){return v.call(t,n)}function l(t,n){var e,i,r,l,o,s,a,h,u,c,p=n&&n.split("/"),f=w.map,d=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(n){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),h=0;h<t.length;h+=1)if(c=t[h],"."===c)t.splice(h,1),h-=1;else if(".."===c){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||d)&&f){for(e=t.split("/"),h=e.length;h>0;h-=1){if(i=e.slice(0,h).join("/"),p)for(u=p.length;u>0;u-=1)if(r=f[p.slice(0,u).join("/")],r&&(r=r[i])){l=r,o=h;break}if(l)break;!s&&d&&d[i]&&(s=d[i],a=h)}!l&&s&&(l=s,o=a),l&&(e.splice(0,o,l),t=e.join("/"))}return t}function o(t,n){return function(){return f.apply(i,T.call(arguments,0).concat([t,n]))}}function s(t){return function(n){return l(n,t)}}function a(t){return function(n){g[t]=n}}function h(t){if(r(m,t)){var n=m[t];delete m[t],b[t]=!0,p.apply(i,n)}if(!r(g,t)&&!r(b,t))throw new Error("No "+t);return g[t]}function u(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function c(t){return function(){return w&&w.config&&w.config[t]||{}}}var p,f,d,y,g={},m={},w={},b={},v=Object.prototype.hasOwnProperty,T=[].slice;d=function(t,n){var e,i=u(t),r=i[0];return t=i[1],r&&(r=l(r,n),e=h(r)),r?t=e&&e.normalize?e.normalize(t,s(n)):l(t,n):(t=l(t,n),i=u(t),r=i[0],t=i[1],r&&(e=h(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:e}},y={require:function(t){return o(t)},exports:function(t){var n=g[t];return"undefined"!=typeof n?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:c(t)}}},p=function(t,n,e,l){var s,u,c,p,f,w,v=[];if(l=l||t,"function"==typeof e){for(n=!n.length&&e.length?["require","exports","module"]:n,f=0;f<n.length;f+=1)if(p=d(n[f],l),u=p.f,"require"===u)v[f]=y.require(t);else if("exports"===u)v[f]=y.exports(t),w=!0;else if("module"===u)s=v[f]=y.module(t);else if(r(g,u)||r(m,u)||r(b,u))v[f]=h(u);else{if(!p.p)throw new Error(t+" missing "+u);p.p.load(p.n,o(l,!0),a(u),{}),v[f]=g[u]}c=e.apply(g[t],v),t&&(s&&s.exports!==i&&s.exports!==g[t]?g[t]=s.exports:c===i&&w||(g[t]=c))}else t&&(g[t]=e)},t=n=f=function(t,n,e,r,l){return"string"==typeof t?y[t]?y[t](n):h(d(t,n).f):(t.splice||(w=t,n.splice?(t=n,n=e,e=null):t=i),n=n||function(){},"function"==typeof e&&(e=r,r=l),r?p(i,t,n,e):setTimeout(function(){p(i,t,n,e)},4),f)},f.config=function(t){return w=t,w.deps&&f(w.deps,w.callback),f},t._defined=g,e=function(t,n,e){n.splice||(e=n,n=[]),r(g,t)||r(m,t)||(m[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("lib/almond",function(){}),function(){var t={}.hasOwnProperty,n=function(n,e){function i(){this.constructor=n}for(var r in e)t.call(e,r)&&(n[r]=e[r]);return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n};e("parse",["require"],function(t){var e,i,r;return e=function(t){function e(t,n){this.input=t,this.type=n}return n(e,t),e.prototype.toString=function(){return"Could not parse '"+this.input+"' as "+this.type},e}(Error),r=function(n){var i;if(i=t("terminals"),/^-?\d+(\.\d+)?$/.test(n)||/^-?\d+(\.\d+)?\/\d+(\.\d+)?$/.test(n))return new i.Constant(n);if(/[a-zA-Z][a-zA-Z_\-\d]*/.test(n))return new i.Variable(n);throw new e(n,"terminal")},i=function(){function n(e){return this.tokens=n.tokenise(e).reverse(),this.upto=0,this.operators=t("operators"),this.parseAddition()}return n.tokenise=function(t){return t.split(/(\*\*|[+*()\-]|\s)/).filter(function(t){return!/^\s*$/.test(t)})},n.prototype.getToken=function(){return this.tokens[this.upto]},n.prototype.parseAddition=function(){var t,n;return n=this.parseMultiplication(),"+"!==this.getToken()?n:(this.upto+=1,t=this.parseAddition(),new this.operators.Add(t,n))},n.prototype.parseMultiplication=function(){var t,n;return n=this.parsePower(),"*"!==this.getToken()?n:(this.upto+=1,t=this.parseMultiplication(),new this.operators.Mul(t,n))},n.prototype.parsePower=function(){var t,n;return t=this.parseBracket(),"**"!==this.getToken()?t:(this.upto+=1,n=this.parsePower(),new this.operators.Pow(n,t))},n.prototype.parseBracket=function(){var t,n;if(")"===this.getToken()){if(this.upto+=1,t=this.parseAddition(),"("!==this.getToken())throw new Error("ParseError: Expected '(' but found '"+this.getToken()+"' at position "+(""+(this.tokens.length-this.upto)+"/"+this.tokens.length+" in token stream '"+this.tokens.reverse().join(" ")+"'"));return this.upto+=1,"-"===this.getToken()?(this.upto+=1,new this.operators.Mul(-1,t)):t}return n=this.parseTerm(),"-"===this.getToken()?(this.upto+=1,new this.operators.Mul(-1,n)):n},n.prototype.parseTerm=function(){var t;return t=r(this.getToken()),this.upto+=1,t},n}(),{ParseError:e,stringToExpression:function(t){return new i(t)},constant:function(t){if("string"==typeof t||t instanceof String){if(""===t)throw new e("","constant");if(t=t.split("/"),1===t.length)return[parseFloat(t[0]),1];if(2===t.length)return[parseFloat(t[0]),parseFloat(t[1])];throw new e(t.join("/"),"constant")}if("number"==typeof t||t instanceof Number)return[t,1];throw new e(t,"constant")},stringToTerminal:r}})}.call(this),function(){e("generateInfo",[],function(){return{getMathMLInfo:function(t,n,e){var i,r,l;return null==e&&(e="0"),r=n?"expression":"equation",l=""+r+"-"+(null!=t?t:Math.floor(1e7*Math.random()).toString(16)),i='<div id="'+l+'" class="'+r+'"><math xmlns="http://www.w3.org/1998/Math/MathML">'+(null!=e?(isFinite(e)?"<mn>"+e+"</mn>":null!=e.toMathML?""+e.toMathML(t,n):"<mi>"+e+"</mi>")+"<mo>=</mo>":""),[r,l,i]},getHTMLInfo:function(t,n,e){var i,r,l;return null==e&&(e="0"),r=n?"expression":"equation",l=""+r+"-"+(null!=t?t:Math.floor(1e7*Math.random()).toString(16)),i='<div id="'+l+'" class="'+r+'">'+(null!=e?(null!=e.toHTML?""+e.toHTML(t,n):""+e)+"=":""),[r,l,i]}}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function i(){this.constructor=n}for(var r in e)t.call(e,r)&&(n[r]=e[r]);return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n};e("terminals",["parse","generateInfo"],function(t,e){var i,r,l,o;return l=function(){function t(t){this.label=t}return t.prototype.evaluate=function(){},t.prototype.copy=function(){return new t(this.label)},t.prototype.toString=function(){return this.label},t}(),i=function(i){function r(n,e){var i,r;this.denominator=null!=e?e:null,this.cmp=-6,null!=this.denominator?(i=t.constant(n),this.numerator=i[0],e=i[1],this.denominator*=e):(r=t.constant(n),this.numerator=r[0],this.denominator=r[1])}return n(r,i),r.prototype.evaluate=function(){return this.numerator/this.denominator},r.prototype.copy=function(){return new r(this.numerator,this.denominator)},r.prototype.compareSameType=function(t){return this.evaluate()<t.evaluate()?-1:this.evaluate()===t.evaluate()?0:1},r.prototype.multiply=function(t){return new r(this.numerator*t.numerator,this.denominator*t.denominator)},r.prototype.add=function(t){return new r(t.denominator*this.numerator+this.denominator*t.numerator,this.denominator*t.denominator)},r.prototype.equals=function(t){return t instanceof r?this.evaluate()===t.evaluate():!1},r.prototype.replaceVariables=function(){return this.copy()},r.prototype.getAllVariables=function(){return[]},r.prototype.sub=function(){return this.copy()},r.prototype.substituteExpression=function(){return this.copy()},r.prototype.toMathML=function(t,n,i,r){var l,o,s,a,h;return null==n&&(n=!1),null==i&&(i="0"),null==r&&(r=!1),r?(h=e.getMathMLInfo(t,n),s=h[0],a=h[1],o=h[2],l="</math></div>"):(o="",l=""),1===this.denominator?"<mn>"+this.numerator+"</mn>":"<mfrac><mrow><mn>"+this.numerator+"</mn></mrow><mrow><mn>"+this.denominator+"</mn></mrow></mfrac>"},r.prototype.toHTML=function(){return 1===this.denominator?""+this.numerator:"("+this.numerator+"/"+this.denominator+")"},r.prototype.toLaTeX=function(){return 1===this.denominator?""+this.numerator:"\\frac{"+this.numerator+"}{"+this.denominator+"}"},r.prototype.toString=function(){return 1!==this.denominator?""+this.numerator+"/"+this.denominator:""+this.numerator},r}(l),r=function(t){function i(t,n){this.label=t,this.value=null!=n?n:null,this.cmp=-5}return n(i,t),i.prototype.copy=function(){return new i(this.label,this.value)},i.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},i.prototype.evaluate=function(){return this.value},i.prototype.equals=function(t){return t instanceof i?this.label===t.label&&this.value===t.value:!1},i.prototype.replaceVariables=function(){return this.copy()},i.prototype.getAllVariables=function(){return[]},i.prototype.sub=function(){return this.copy()},i.prototype.substituteExpression=function(){return this.copy()},i.prototype.toHTML=function(){return this.toString()},i.prototype.toMathML=function(t,n,i,r){var l,o,s,a,h;return null==n&&(n=!1),null==i&&(i="0"),null==r&&(r=!1),r?(h=e.getMathMLInfo(t,n),s=h[0],a=h[1],o=h[2],l="</math></div>"):(o="",l=""),""+o+"<mn>"+this.label+"</mn>"+l},i.prototype.toLaTeX=function(){return this.toString()},i}(l),o=function(t){function r(t){this.label=t,this.cmp=-4}return n(r,t),r.prototype.copy=function(){return new r(this.label)},r.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},r.prototype.equals=function(t){return t instanceof r?t.label===this.label:!1},r.prototype.replaceVariables=function(t){return this.label in t?this.label=t[this.label]:void 0},r.prototype.getAllVariables=function(){return[this.label]},r.prototype.sub=function(t){var n;return this.label in t?(n=t[this.label],null!=n.copy?n.copy():new i(n)):this.copy()},r.prototype.substituteExpression=function(t,n){return this.label===n?t.copy():this.copy()},r.prototype.toMathML=function(t,n,i,r){var l,o,s,a,h,u,c,p;return null==n&&(n=!1),null==i&&(i="0"),null==r&&(r=!1),r?(p=e.getMathMLInfo(t,n),u=p[0],c=p[1],o=p[2],l="</math></div>"):(o="",l=""),a=this.label.split("-"),s=a[0],h=null!=a[1]?'id="variable-'+(n?"expression":"equation")+("-"+t+"-")+this.label+'"':"",s.length>1?o+'<msub class="variable"'+h+"><mi>"+s[0]+"</mi><mi>"+s.slice(1)+"</mi></msub>"+l:o+'<mi class="variable"'+h+">"+s+"</mi>"+l},r.prototype.toHTML=function(t,n,e,i){var r,l,o;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),l=this.label.split("-"),r=l[0],o=null!=l[1]?'id="variable-'+(n?"expression":"equation")+("-"+t+"-")+this.label+'"':"",'<span class="variable"'+o+">"+r+"</span>"},r.prototype.toLaTeX=function(){return this.toString()},r}(l),{Terminal:l,Variable:o,Constant:i,SymbolicConstant:r}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function i(){this.constructor=n}for(var r in e)t.call(e,r)&&(n[r]=e[r]);return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n};e("nodes",[],function(){var t;return t=function(){function t(t){this.label=t}return t.prototype.getChildren=function(){return[]},t}(),{BasicNode:t,RoseNode:function(t){function e(t,n){this.children=null!=n?n:null,null==this.children&&(this.children=[]),e.__super__.constructor.call(this,t)}return n(e,t),e.prototype.getChildren=function(){return this.children},e.prototype.toLisp=function(){return"("+this.label+(this.children?" ":"")+this.children.join(" ")+")"},e.prototype.toString=function(){return"("+this.children.join(" "+this.label+" ")+")"},e}(t),BinaryNode:function(t){function e(t,n,e){this.label=t,this.children={left:n,right:e}}return n(e,t),e.prototype.getChildren=function(){return[this.children.left,this.children.right]},e.prototype.toLisp=function(){return"("+this.label+" "+this.children.left+" "+this.children.right+")"},e.prototype.toString=function(){return"("+this.children.left+" "+this.label+" "+this.children.right+")"},e}(t)}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function i(){this.constructor=n}for(var r in e)t.call(e,r)&&(n[r]=e[r]);return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n},i=[].slice;e("operators",["nodes","parse","terminals","generateInfo"],function(t,e,r,l){var o,s,a,h,u,c,p;return s=function(t){function e(t,n,i){null==i&&(i=null),e.__super__.constructor.call(this,"Unsolvable: "+t+" for "+n+(i?";"+i:""))}return n(e,t),e}(Error),p=function(t){var n,e,i,r;for(e=[],i=0,r=t.length;r>i;i++)n=t[i],n instanceof Array?e.push(p(n)):e.push("function"==typeof n.toString?n.toString():void 0);return"["+e.join(", ")+"]"},c=function(){var n,l,o,s,a;for(l=1<=arguments.length?i.call(arguments,0):[],o=[],s=0,a=l.length;a>s;s++)if(n=l[s],"string"==typeof n||n instanceof String)o.push(e.stringToTerminal(n));else if("number"==typeof n||n instanceof Number)o.push(new r.Constant(n));else{if(!(n instanceof r.Terminal||n instanceof t.BasicNode||null!=n.isTerminal))throw new Error("Invalid argument "+n+", ("+typeof n+"), ("+n.toString()+")");o.push(n)}return o},o=function(e){function o(){var t;if(t=1<=arguments.length?i.call(arguments,0):[],t.length<1)throw new Error("Add nodes must have at least one child.");this.cmp=-1,t=c.apply(null,t),o.__super__.constructor.call(this,"+",t)}return n(o,e),o.prototype.copy=function(){var t,n;return t=function(){var t,e,i,r;for(i=this.children,r=[],t=0,e=i.length;e>t;t++)n=i[t],r.push(null!=n.copy?n.copy():n);return r}.call(this),function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,t,function(){})},o.prototype.compareSameType=function(t){var n,e,i,r,l,o,s;for(r=this.children.length===t.children.length?0:this.children.length<t.children.length?-1:1,s=this.children,i=l=0,o=s.length;o>l;i=++l){if(e=s[i],null==t.children[i])return 1;if(n=u(this.children[i],t.children[i]),0!==n)return n}return r},o.prototype.expand=function(){var t,n,e,i,r,l,s,a,h,u;for(i=[],h=this.children,r=0,s=h.length;s>r;r++)if(e=h[r],null!=e.expand?e=e.expand():null!=e.copy&&(e=e.copy()),e instanceof o)for(u=e.children,l=0,a=u.length;a>l;l++)n=u[l],i.push(n);else i.push(e);return t=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,i,function(){}),t.sort(),t},o.prototype.sort=function(){var t,n,e,i;for(i=this.children,n=0,e=i.length;e>n;n++)t=i[n],"function"==typeof t.sort&&t.sort();return this.children.sort(u)},o.prototype.equals=function(t){var n,e,i,r,l;if(!(t instanceof o))return!1;if(t.children.length!==this.children.length)return!1;for(l=this.children,e=i=0,r=l.length;r>i;e=++i)if(n=l[e],null!=n.equals){if(!n.equals(t.children[e]))return!1}else if(n!==t.children[e])return!1;return!0},o.prototype.simplify=function(){var t,n,e,i,l,s,h,u,c,p,f,d,y,g,m,w,b,v,T,M,x,S,V,L,A,C,q,E,_,j;for(y=[],E=this.children,w=0,M=E.length;M>w;w++)n=E[w],null!=n.simplify?n=n.simplify():null!=n.copy&&(n=n.copy()),y.push(n);for(c=[],e=null,s=0;s<y.length;){if(d=y[s],d instanceof o){for(y.splice(s,1)[0],_=d.children,b=0,x=_.length;x>b;b++)t=_[b],y.push(t);s-=1}else if(d instanceof r.Constant)e=null!=e?e.add(d):d.copy();else if(d instanceof a){for(i=null,g=null,j=d.children,v=0,S=j.length;S>v;v++)n=j[v],n instanceof r.Constant?i=null!=i?i.multiply(n):n.copy():null!=g?g.children.push(n):g=new a(n);if(1===g.children.length&&(g=g.children[0]),null!=i&&null==g)e=null!=e?e.add(i):i.copy();else{for(null==i&&(i=new r.Constant("1")),l=!1,h=T=0,V=c.length;V>T;h=++T)u=c[h],null!=u[0].equals?u[0].equals(g)&&(c[h][1]=new o(u[1],i),c[h][1]=c[h][1].simplify(),l=!0):u[0]===g&&(c[h][1]=new o(u[1],i),c[h][1]=c[h][1].simplify(),l=!0);l||c.push([g,i])}}else{for(l=!1,h=C=0,L=c.length;L>C;h=++C)u=c[h],null!=u[0].equals?u[0].equals(d)&&(c[h][1]=new o(u[1],new r.Constant("1")),c[h][1]=c[h][1].simplify(),l=!0):u[0]===d&&(c[h][1]=new o(u[1],new r.Constant("1")),c[h][1]=c[h][1].simplify(),l=!0);l||c.push([d,new r.Constant("1")])}s+=1}for(p=null,q=0,A=c.length;A>q;q++)u=c[q],null!=u[0].children&&1===u[0].children.length&&(u[0]=u[0].children[0]),1!==("function"==typeof(m=u[1]).evaluate?m.evaluate():void 0)?(f=new a(u[0],u[1]),f=f.simplify()):f=u[0],null!=p?p.children.push(f):p=new o(f);return null==p?e:(null!=e&&0!==e.evaluate()&&p.children.push(e),p.sort(),1!==p.children.length?p:p.children[0])},o.prototype.expandAndSimplify=function(){var t;return t=this.expand(),null!=t.simplify?t.simplify():t},o.prototype.solve=function(t){var n,e,i,l,u,c,p,f,d,y,g,m,w,b,v,T,M,x,S,V,L,A,C,q,E,_,j,k,O,H,N,I,X,P,B,F,z,R,$,U,Z,G,Q,D,J,K,W,Y,tn;if(d=this.expandAndSimplify(),X=[],P=[],d instanceof r.Terminal){if(d instanceof r.Variable&&d.label===t)return[new r.Constant("0")];throw new s(d.toString(),t)}if(!(d instanceof o))return d.solve(t);for(W=d.children,z=0,Z=W.length;Z>z;z++)if(I=W[z],null!=I.copy&&(I=I.copy()),I instanceof h)I.children.left instanceof r.Variable&&I.children.left.label===t?X.push(I):P.push(I);else if(I instanceof a){for(l=!1,Y=I.children,R=0,G=Y.length;G>R;R++){if(H=Y[R],H instanceof r.Variable&&H.label===t){X.push(I),l=!0;break}if(H instanceof h&&H.children.left instanceof r.Variable&&H.children.left.label===t){X.push(I),l=!0;break}}l||P.push(I)}else I instanceof r.Variable&&I.label===t?X.push(I):P.push(I);if(0===X.length)throw new s(d.toString(),t);for(console.log("Solving "+this+" for "+t+": Terms containing are ("+X+"), terms not are ("+P+")"),y=[],m=[],M=[],S=[],$=0,Q=X.length;Q>$;$++)if(I=X[$],I instanceof r.Variable)y.push(new r.Constant("1"));else if(I instanceof h){if(!(I.children.right instanceof r.Constant))throw new s(d.toString(),t);if(j=I.children.right.evaluate(),!(I.children.left instanceof r.Variable&&I.children.left.label===t))throw new s(d.toString(),t," (this shouldn't happen)");if(1===j)y.push(new r.Constant("1"));else if(2===j)m.push(new r.Constant("1"));else if(-1===j)M.push(new r.Constant("1"));else{if(-2!==j)throw new s(d.toString(),t," (not supported)");S.push(new r.Constant("1"))}}else if(I instanceof a){for(N=[],k=!1,v=!1,T=!1,tn=I.children,U=0,D=tn.length;D>U;U++)if(H=tn[U],H instanceof r.Variable&&H.label===t);else if(H instanceof h){if(!(H.children.right instanceof r.Constant))throw new s(d.toString(),t);if(j=H.children.right.evaluate(),H.children.left instanceof r.Variable&&H.children.left.label===t)if(1===j);else if(2===j)k=!0;else if(-1===j)v=!0;else{if(-2!==j)throw new s(d.toString(),t," (not supported)");T=!0}else N.push(H)}else N.push(H);b=N.length>0?function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(a,N,function(){}):new r.Constant("1"),k?m.push(b):v?M.push(b):T?S.push(b):y.push(b)}for(L=[],K=0,J=P.length;J>K;K++)I=P[K],q=new a("-1",null!=I.copy?I.copy():I),q=q.simplify(),L.push(q);if(0!==L.length&&(A=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,L,function(){})),0!==P.length&&(_=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,P,function(){})),0!==y.length&&(g=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,y,function(){})),0!==m.length&&(w=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,m,function(){})),0!==M.length&&(x=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,M,function(){})),0!==S.length&&(V=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,S,function(){})),console.log("Sorted terms. Negated: "+L+"; Factorised: "+y+"; Squares: "+m+"; Inversed: "+M+"; Inversed Squares: "+S),0===L.length&&(A=new r.Constant("0")),0===m.length){if(0===y.length){if(0===M.length){if(0===S.length)throw new s(d.toString(),t);return u=new a(new h(V,"1/2"),new h(A,"-1/2")),e=new a(-1,u.copy()),e=e.expandAndSimplify(),i=u.expandAndSimplify(),("function"==typeof e.equals?e.equals(i):void 0)?[e]:[e,i]}return 0===S.length?(u=new a(x,new h(A,"-1")),[u.expandAndSimplify()]):(C=new o(new a(_,new h(new r.Variable(t),2)),new a(x,new r.Variable(t)),V),console.log("Recursing into Add.solve with ("+C+")"),C.solve(t))}if(0===M.length){if(0===S.length)return u=new a(A,new h(g,"-1")),[u.expandAndSimplify()];throw new s(d.toString(),t," (not supported)")}throw new s(d.toString(),t," (not supported)")}if(0===y.length){if(0===M.length){if(0===S.length)return u=new h(new a(A,new h(w,"-1")),"1/2"),e=new a("-1",u.copy()),e=e.expandAndSimplify(),i=u.expandAndSimplify(),("function"==typeof e.equals?e.equals(i):void 0)?[e]:[e,i];throw new s(d.toString(),t," (not supported)")}throw new s(d.toString(),t," (not supported)")}if(M.length>0||S.length>0)throw new s(d.toString(),t," (not supported)");return null!=_?(n=w,c=g,p=_,f=new o(new h(c,"2"),new a("-4",n,p)),O=new h(f,"1/2"),B=new a(new o(new a("-1",c),O),new h(new a("2",n),"-1")),F=new a("-1",new o(c,O),new h(new a("2",n),"-1")),B=B.expandAndSimplify(),F=F.expandAndSimplify(),null!=B.equals&&B.equals(F)?[B]:[B,F]):(E=new h(w,"-1"),q=new a("-1",g,E),q=q.simplify(),[0,q])},o.prototype.getAllVariables=function(){var t,n,e,i,l,o,s,a,h,u;for(l={},u=this.children,o=0,a=u.length;a>o;o++)if(t=u[o],t instanceof r.Variable)l[t.label]=!0;else if(null!=t.getAllVariables)for(n=t.getAllVariables(),s=0,h=n.length;h>s;s++)i=n[s],l[i]=!0;e=[];for(i in l)e.push(i);return e},o.prototype.replaceVariables=function(t){var n,e,i,l,o,s;for(o=this.children,s=[],e=i=0,l=o.length;l>i;e=++i)n=o[e],n instanceof r.Variable&&n.label in t?s.push(this.children[e].label=t[n.label]):null!=n.replaceVariables?s.push(n.replaceVariables(t)):s.push(void 0);return s},o.prototype.sub=function(n){var e,i,l,s,a,h,u;for(s in n)n[s]instanceof r.Terminal||n[s]instanceof t.BasicNode||(n[s]=new r.Constant(n[s]));for(i=[],u=this.children,a=0,h=u.length;h>a;a++)e=u[a],e instanceof r.Variable&&e.label in n?i.push(n[e.label].copy()):null!=e.sub?i.push(e.sub(n)):i.push(e.copy());return l=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,i,function(){}),l=l.expandAndSimplify()},o.prototype.substituteExpression=function(t,n,e){var i,l,s,a,h,u;for(null==e&&(e=null),l=[],u=this.children,a=0,h=u.length;h>a;a++)i=u[a],i instanceof r.Variable&&i.label===n?l.push(t.copy()):null!=i.substituteExpression?l.push(i.substituteExpression(t,n,e)):l.push(i.copy());return s=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,l,function(){}),s.expandAndSimplify()},o.prototype.toMathML=function(t,n,e,i){var r,o,s,a,h;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),h=l.getMathMLInfo(t,n,e),s=h[0],a=h[1],o=h[2],i?r="</math></div>":(o="",r=""),o+"<mrow>"+this.children.map(function(e){return e.toMathML(t,n)}).join("<mo>+</mo>")+"</mrow>"+r},o.prototype.toHTML=function(t,n,e,i){var r,o,s,a,h;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),h=l.getHTMLInfo(t,n,e),s=h[0],a=h[1],o=h[2],i?r="</div>":(o="",r=""),o+this.children.map(function(t){return t.toHTML()}).join("+")+r},o.prototype.toLaTeX=function(){return this.children.map(function(t){return t.toLaTeX()}).join("+")},o}(t.RoseNode),a=function(e){function a(){var t;if(t=1<=arguments.length?i.call(arguments,0):[],t.length<1)throw new Error("Mul nodes must have at least one child.");this.cmp=-2,t=c.apply(null,t),a.__super__.constructor.call(this,"*",t)}return n(a,e),a.prototype.copy=function(){var t,n;return t=function(){var t,e,i,r;for(i=this.children,r=[],t=0,e=i.length;e>t;t++)n=i[t],r.push(null!=n.copy?n.copy():n);return r}.call(this),function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(a,t,function(){})},a.prototype.simplifyConstants=function(){var t,n,e,i,l,o;for(n=new r.Constant("1"),e=null,o=this.children,i=0,l=o.length;l>i;i++)t=o[i],t instanceof r.Constant?n=n.multiply(t):null!=e?e.children.push(t):e=new a(t);return null==e?n:1===n.evaluate()?e:new a(n,e)},a.prototype.compareSameType=function(t){var n,e,i,r,l,o,s;for(r=this.children.length===t.children.length?0:this.children.length<t.children.length?-1:1,s=this.children,i=l=0,o=s.length;o>l;i=++l){if(e=s[i],null==t.children[i])return 1;if(n=u(this.children[i],t.children[i]),0!==n)return n}return r},a.expandMulAdd=function(t,n){var e,i,r,l,s,h,u,c,p,f,d;for(s=[],f=n.children,h=0,c=f.length;c>h;h++){if(i=f[h],null!=i.copy&&(i=i.copy()),i instanceof a)for(l=t.copy(),d=i.children,u=0,p=d.length;p>u;u++)e=d[u],l.children.push(e);else i instanceof o?l=a.expandMulAdd(t,i):1===t.children.length?(l=t.copy(),l.children.push(i.copy())):l=new a(t.copy(),i.copy());s.push(l)}return r=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,s,function(){}),r=r.expand()},a.prototype.equals=function(t){var n,e,i,r,l;if(!(t instanceof a))return!1;if(t.children.length!==this.children.length)return!1;for(l=this.children,e=i=0,r=l.length;r>i;e=++i)if(n=l[e],null!=n.equals){if(!n.equals(t.children[e]))return!1}else if(n!==t.children[e])return!1;return!0},a.prototype.expand=function(){var t,n,e,i,r,l,s,h,u,c,p,f,d,y;for(i=[],f=this.children,l=0,u=f.length;u>l;l++)t=f[l],null!=t.expand?t=t.expand():null!=t.copy&&(t=t.copy()),i.push(t);for(;i.length>1;)if(i[0]instanceof a)if(i[1]instanceof o)i[0]=a.expandMulAdd(i[0],i.splice(1,1)[0]);else if(i[1]instanceof a)for(d=i.splice(1,1)[0].children,s=0,c=d.length;c>s;s++)t=d[s],i[0].children.push(t);else i[0].children.push(i.splice(1,1)[0]);else if(i[0]instanceof o)if(i[1]instanceof o){for(e=[],y=i[0].children,h=0,p=y.length;p>h;h++)t=y[h],n=new a(t,i[1]),n=n.expand(),e.push(n);i.splice(1,1),i[0]=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(o,e,function(){}),i[0]=i[0].expand()}else i[0]=i[1]instanceof a?a.expandMulAdd(i.splice(1,1)[0],i[0]):new a(i[0],i.splice(1,1)[0]);else i[0]=new a(i[0]);return"function"==typeof(r=i[0]).sort&&r.sort(),i[0]},a.prototype.simplify=function(){var t,n,e,i,l,s,u,c,p,f,d,y,g,m,w,b,v,T,M,x,S,V,L,A,C,q,E,_,j,k,O,H,N,I,X;for(w=[],j=this.children,v=0,S=j.length;S>v;v++)e=j[v],null!=e.simplify?e=e.simplify():null!=e.copy&&(e=e.copy()),w.push(e);for(p=[],i=null,s=0;s<w.length;){if(m=w[s],m instanceof a){for(e=w.splice(s,1)[0],k=e.children,T=0,V=k.length;V>T;T++)n=k[T],w.push(n);s-=1}else if(m instanceof r.Constant)i=null!=i?i.multiply(m):m.copy();else if(m instanceof h){for(t=m.children.left,g=m.children.right,l=!1,u=M=0,L=p.length;L>M;u=++M)c=p[u],null!=c[0].equals?c[0].equals(t)&&(p[u][1]=new o(c[1],g),p[u][1]=p[u][1].simplify(),1===(null!=(O=p[u][1].children)?O.length:void 0)&&(p[u][1]=p[u][1].children[0]),l=!0):c[0]===t&&(p[u][1]=new o(c[1],g),p[u][1]=p[u][1].simplify(),1===(null!=(H=p[u][1].children)?H.length:void 0)&&(p[u][1]=p[u][1].children[0]),l=!0);l||p.push([t,g])}else{for(l=!1,u=x=0,A=p.length;A>x;u=++x)c=p[u],null!=c[0].equals?c[0].equals(m)&&(p[u][1]=new o(c[1],new r.Constant("1")),p[u][1]=p[u][1].simplify(),1===(null!=(N=p[u][1].children)?N.length:void 0)&&(p[u][1]=p[u][1].children[0]),l=!0):c[0]===m&&(p[u][1]=new o(c[1],new r.Constant("1")),p[u][1]=p[u][1].simplify(),1===(null!=(I=p[u][1].children)?I.length:void 0)&&(p[u][1]=p[u][1].children[0]),l=!0);l||p.push([m,new r.Constant("1")])}s+=1}if(0===(null!=i?"function"==typeof i.evaluate?i.evaluate():void 0:void 0))return new r.Constant("0");for(f=null,E=0,C=p.length;C>E;E++)c=p[E],1!==("function"==typeof(b=c[1]).evaluate?b.evaluate():void 0)?(d=new h(c[0],c[1]),d=d.simplify()):d=c[0],null!=f?f.children.push(d):f=new a(d);if(null==f)return i;for(null!=i&&1!==i.evaluate()&&f.children.push(i),f.sort(),y=!0,X=f.children,_=0,q=X.length;q>_;_++)if(e=X[_],!(e instanceof r.Constant)){y=!1;break}return y?f.simplifyConstants():1!==f.children.length?f:f.children[0]},a.prototype.sort=function(){var t,n,e,i;for(i=this.children,n=0,e=i.length;e>n;n++)t=i[n],"function"==typeof t.sort&&t.sort();return this.children.sort(u)},a.prototype.expandAndSimplify=function(){var t;return t=this.expand(),null!=t.simplify?t.simplify():t},a.prototype.solve=function(t){var n,e,i,l,o,u;if(i=this.expandAndSimplify(),i instanceof r.Terminal){if(i instanceof r.Variable&&i.label===t)return[new r.Constant("0")];throw new s(i.toString(),t)}if(!(i instanceof a))return i.solve(t);for(u=i.children,l=0,o=u.length;o>l;l++){if(n=u[l],n instanceof r.Variable&&n.label===t)return[new r.Constant("0")];if(n instanceof h)try{return n.solve(t)}catch(c){if(e=c,e instanceof s)continue;throw e}}throw new s(i.toString(),t)},a.prototype.getAllVariables=function(){var t,n,e,i,l,o,s,a,h,u;for(l={},u=this.children,o=0,a=u.length;a>o;o++)if(t=u[o],t instanceof r.Variable)l[t.label]=!0;else if(null!=t.getAllVariables)for(n=t.getAllVariables(),s=0,h=n.length;h>s;s++)i=n[s],l[i]=!0;e=[];for(i in l)e.push(i);return e},a.prototype.replaceVariables=function(t){var n,e,i,l,o,s;for(o=this.children,s=[],e=i=0,l=o.length;l>i;e=++i)n=o[e],n instanceof r.Variable&&n.label in t?s.push(this.children[e].label=t[n.label]):null!=n.replaceVariables?s.push(n.replaceVariables(t)):s.push(void 0);return s},a.prototype.sub=function(n){var e,i,l,o,s,h,u;for(o in n)n[o]instanceof r.Terminal||n[o]instanceof t.BasicNode||(n[o]=new r.Constant(n[o]));for(i=[],u=this.children,s=0,h=u.length;h>s;s++)e=u[s],e instanceof r.Variable&&e.label in n?i.push(n[e.label].copy()):null!=e.sub?i.push(e.sub(n)):i.push(e.copy());return l=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(a,i,function(){}),l=l.expandAndSimplify()},a.prototype.substituteExpression=function(t,n,e){var i,l,o,s,h,u;for(null==e&&(e=null),l=[],u=this.children,s=0,h=u.length;h>s;s++)i=u[s],i instanceof r.Variable&&i.label===n?l.push(t.copy()):null!=i.substituteExpression?l.push(i.substituteExpression(t,n,e)):l.push(i.copy());return o=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(a,l,function(){}),o.expandAndSimplify()},a.prototype.toMathML=function(t,n,e,i){var r,s,a,h,u;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),u=l.getMathMLInfo(t,n,e),a=u[0],h=u[1],s=u[2],i?r="</math></div>":(s="",r=""),s+"<mrow>"+this.children.map(function(e){return e instanceof o?"<mfenced>"+e.toMathML(t,n)+"</mfenced>":e.toMathML(t,n)}).join("<mo>&middot;</mo>")+"</mrow>"+r},a.prototype.toHTML=function(t,n,e,i){var r,s,a,h,u;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),u=l.getHTMLInfo(t,n,e),a=u[0],h=u[1],s=u[2],i?r="</div>":(s="",r=""),s+this.children.map(function(t){return t instanceof o?"("+t.toHTML()+")":t.toHTML()}).join("&middot;")+r},a.prototype.toLaTeX=function(){return this.children.map(function(t){return t instanceof o?"\\left("+t.toLaTeX()+"\\right)":t.toLaTeX()}).join("\\cdot")},a}(t.RoseNode),h=function(e){function h(){var t,n,e,r;if(n=arguments[0],e=arguments[1],t=3<=arguments.length?i.call(arguments,2):[],null==n||null==e)throw new Error("Pow nodes must have two children.");if(t.length>0)throw new Error("Pow nodes must have two children.");this.cmp=-3,r=c(n,e),n=r[0],e=r[1],h.__super__.constructor.call(this,"**",n,e)}return n(h,e),h.prototype.copy=function(){return new h(null!=this.children.left.copy?this.children.left.copy():this.children.left,null!=this.children.right.copy?this.children.right.copy():this.children.right)},h.prototype.sort=function(){var t,n;return"function"==typeof(t=this.children.left).sort&&t.sort(),"function"==typeof(n=this.children.right).sort?n.sort():void 0},h.prototype.equals=function(t){if(!(t instanceof h))return!1;if(null!=this.children.left.equals){if(!this.children.left.equals(t.children.left))return!1}else if(this.children.left!==t.children.left)return!1;if(null!=this.children.right.equals){if(!this.children.right.equals(t.children.right))return!1}else if(this.children.right!==t.children.right)return!1;return!0},h.prototype.compareSameType=function(t){var n;return n=u(this.children.left,t.children.left),0!==n?n:u(this.children.right,t.children.right)},h.prototype.expand=function(){var t,n,e,i,l,s,u,c,p,f,d,y,g;if(l=null!=this.children.left.expand?this.children.left.expand():null!=this.children.left.copy?this.children.left.copy():this.children.left,c=null!=this.children.right.expand?this.children.right.expand():null!=this.children.right.copy?this.children.right.copy():this.children.right,null!=l.children){if(l instanceof h)l.children.right=new a(l.children.right,c),l.expand();
else if(l instanceof a)for(y=l.children,i=p=0,d=y.length;d>p;i=++p)t=y[i],u=new h(t,c),u=u.expand(),l.children[i]=u;else if(l instanceof o)if(c instanceof r.Constant&&0===c.evaluate()%1&&c.evaluate()>0){for(n=[],e=f=1,g=c.evaluate();g>=1?g>=f:f>=g;e=g>=1?++f:--f)n.push(l);s=function(t,n,e){e.prototype=t.prototype;var i=new e,r=t.apply(i,n);return Object(r)===r?r:i}(a,n,function(){}),s=s.expand(),l=s}else l=new h(l,c);return l}return new h(l,c)},h.prototype.simplify=function(){var t,n,e,i;return t=null!=this.children.left.simplify?this.children.left.simplify():null!=this.children.left.copy?this.children.left.copy():this.children.left,i=null!=this.children.right.simplify?this.children.right.simplify():null!=this.children.right.copy?this.children.right.copy():this.children.right,1===("function"==typeof i.evaluate?i.evaluate():void 0)?t:1===("function"==typeof t.evaluate?t.evaluate():void 0)?t:0===("function"==typeof i.evaluate?i.evaluate():void 0)?new r.Constant("1"):i instanceof r.Constant&&t instanceof r.Constant?new r.Constant(Math.pow(t.evaluate(),i.evaluate())):t instanceof h?(e=new a(t.children.right,i),n=new h(t.children.left,e),n=n.simplify()):new h(t,i)},h.prototype.expandAndSimplify=function(){var t;return t=this.expand(),null!=t.simplify?t.simplify():t},h.prototype.solve=function(t){var n,e,i,l,o,u,c,p;if(e=this.expandAndSimplify(),e instanceof r.Terminal){if(e instanceof r.Variable&&e.label===t)return[new r.Constant("0")];throw new s(e.toString(),t)}if(e instanceof h){if(e.children.left instanceof r.Variable){if(e.children.left.label===t)return[new r.Constant("0")];throw new s(e.toString(),t)}if(e.children.left instanceof r.Terminal)throw new s(e.toString(),t);try{u=e.children.left.solve(t)}catch(f){throw n=f}if(null!=e.children.right.evaluate&&0===e.children.right.evaluate()%2){for(l=[],c=0,p=u.length;p>c;c++)o=u[c],i=new a(-1,o).simplify(),null!=i.equals?(i.equals(o)||l.push(i),l.push(o)):(i!==o&&l.push(i),l.push(o));return l}return u}return e.solve(t)},h.prototype.sub=function(n){var e,i,l,o;for(o in n)n[o]instanceof r.Terminal||n[o]instanceof t.BasicNode||(n[o]=new r.Constant(n[o]));return e=null,l=null,e=this.children.left instanceof r.Variable&&this.children.left.label in n?n[this.children.left.label].copy():null!=this.children.left.sub?this.children.left.sub(n):this.children.left.copy(),l=this.children.right instanceof r.Variable&&this.children.right.label in n?n[this.children.right.label].copy():null!=this.children.right.sub?this.children.right.sub(n):this.children.right.copy(),i=new h(e,l),i=i.expandAndSimplify()},h.prototype.getAllVariables=function(){var t,n,e,i,l,o,s,a,h;if(l={},this.children.left instanceof r.Variable)l[this.children.left.label]=!0;else if(null!=this.children.left.getAllVariables)for(t=this.children.left.getAllVariables(),o=0,a=t.length;a>o;o++)i=t[o],l[i]=!0;if(this.children.right instanceof r.Variable)l[this.children.right.label]=!0;else if(null!=this.children.right.getAllVariables)for(e=this.children.right.getAllVariables(),s=0,h=e.length;h>s;s++)i=e[s],l[i]=!0;n=[];for(i in l)n.push(i);return n},h.prototype.replaceVariables=function(t){return this.children.left instanceof r.Variable&&this.children.left.label in t?this.children.left.label=t[this.children.left.label]:null!=this.children.left.replaceVariables&&this.children.left.replaceVariables(t),this.children.right instanceof r.Variable&&this.children.right.label in t?this.children.right.label=t[this.children.right.label]:null!=this.children.right.replaceVariables?this.children.right.replaceVariables(t):void 0},h.prototype.substituteExpression=function(t,n,e){var i,l,o;return null==e&&(e=null),i=this.children.left.copy(),o=this.children.right.copy(),this.children.left instanceof r.Variable&&this.children.left.label===n?i=t.copy():this.children.left instanceof r.Terminal||(i=this.children.left.substituteExpression(t,n,e)),this.children.right instanceof r.Variable&&this.children.right.label===n?o=t.copy():this.children.right instanceof r.Terminal||(o=this.children.right.substituteExpression(t,n,e)),l=new h(i,o),l=l.expandAndSimplify()},h.prototype.toMathML=function(t,n,e,i){var r,s,h,u,c,p,f,d,y,g,m;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),m=l.getMathMLInfo(t,n,e),u=m[0],c=m[1],s=m[2],i?r="</math></div>":(s="",r=""),1===("function"==typeof(f=this.children.right).evaluate?f.evaluate():void 0)?s+this.children.left.toMathML(t,n)+r:0===("function"==typeof(d=this.children.right).evaluate?d.evaluate():void 0)?s+"<mn>1</mn>"+r:(("function"==typeof(y=this.children.right).evaluate?y.evaluate():void 0)<0?(p=this.children.right.copy(),p=new a("-1",p),p=p.expandAndSimplify()):p=this.children.right.copy(),h=this.children.left instanceof o||this.children.left instanceof a?"<mfenced>"+this.children.left.toMathML(t,n)+"</mfenced>":""+this.children.left.toMathML(t,n),1!==("function"==typeof p.evaluate?p.evaluate():void 0)&&(h="<msup>"+h+p.toMathML(t,n)+"</msup>"),("function"==typeof(g=this.children.right).evaluate?g.evaluate():void 0)<0&&(h="<mfrac><mn>1</mn>"+h+"</mfrac>"),s+h+r)},h.prototype.toHTML=function(t,n,e,i){var o,s,a,h,u,c,p,f,d,y;return null==n&&(n=!1),null==e&&(e="0"),null==i&&(i=!1),y=l.getHTMLInfo(t,n,e),u=y[0],c=y[1],s=y[2],i?o="</div>":(s="",o=""),1===("function"==typeof(f=this.children.right).evaluate?f.evaluate():void 0)?s+this.children.left.toHTML()+o:0===("function"==typeof(d=this.children.right).evaluate?d.evaluate():void 0)?s+"1"+o:(h=this.children.left instanceof r.Terminal?this.children.left.toHTML():"("+this.children.left.toHTML()+")",p=this.children.right instanceof r.Terminal?this.children.right.toHTML():"("+this.children.right.toHTML()+")",a=""+h+" ** "+p,s+a+o)},h.prototype.toLaTeX=function(){var t,n,e,i,r;return 1===("function"==typeof(e=this.children.right).evaluate?e.evaluate():void 0)?this.children.left.toLaTeX():0===("function"==typeof(i=this.children.right).evaluate?i.evaluate():void 0)?"1":(t=this.children.left instanceof o||this.children.left instanceof a?"\\left("+this.children.left.toLaTeX()+"\\right)^{"+this.children.right.toLaTeX()+"}":""+this.children.left.toLaTeX()+"^{"+this.children.right.toLaTeX()+"}",("function"==typeof(r=this.children.right).evaluate?r.evaluate():void 0)<0&&(n=this.children.right.copy(),n=new a("-1",n),n=n.simplify(),t="\\frac{1}{"+t+"}"),t)},h}(t.BinaryNode),u=function(t,n){return null!=t.cmp&&null!=n.cmp?t.cmp===n.cmp?t.compareSameType(n):(t.cmp-n.cmp)/Math.abs(t.cmp-n.cmp):0},{Add:o,Mul:a,Pow:h,compare:u,AlgebraError:s}})}.call(this),function(){var t=[].slice,n=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("Equation",["terminals","nodes","operators","parse"],function(e,i,r,l){var o;return o=function(){function o(){var n,r;switch(n=1<=arguments.length?t.call(arguments,0):[],n.length){case 1:if(n[0]instanceof String||"string"==typeof n[0])switch(r=n[0].split("="),r.length){case 1:this.left=new e.Constant("0"),this.right=l.stringToExpression(r[0]),this.right=this.right.simplify();break;case 2:this.left=l.stringToTerminal(r[0]),this.right=l.stringToExpression(r[1]),this.right=this.right.simplify();break;default:throw new Error("Too many '=' signs.")}else{if(!(n[0]instanceof e.Terminal||n[0]instanceof i.BasicNode))throw new Error("Argument "+n[0]+" must be a String, Terminal, or Node.");this.left=new e.Constant("0"),this.right=n[0].copy()}break;case 2:if(n[0]instanceof String||"string"==typeof n[0])this.left=l.stringToTerminal(n[0]);else{if(!(n[0]instanceof e.Terminal||n[0]instanceof i.BasicNode))throw new Error("Argument "+n[0]+" must be a String, Terminal, or Node.");this.left=n[0].copy()}if(n[1]instanceof String||"string"==typeof n[1])this.right=l.stringToExpression(n[1]),this.right=this.right.simplify();else{if(!(n[1]instanceof e.Terminal||n[1]instanceof i.BasicNode))throw new Error("Argument "+n[1]+" must be a String, Terminal, or Node.");this.right=n[1].copy()}break;default:throw new Error("Too many arguments.")}}return o.prototype.solve=function(t){var n,e;return n=new r.Add(this.right,new r.Mul("-1",this.left)),e=n.solve(t),console.log(t,l.stringToTerminal(t)),e.map(function(n){return new o(t,n)})},o.prototype.replaceVariables=function(t){return this.left.replaceVariables(t),this.right.replaceVariables(t)},o.prototype.getAllVariables=function(){var t,e,i,r,l;for(t=this.left.getAllVariables(),e=this.right.getAllVariables(),r=0,l=t.length;l>r;r++)i=t[r],n.call(e,i)<0&&e.unshift(i);return e},o.prototype.sub=function(t){var n;return this.left instanceof e.Variable&&this.left.label in t?(n=new r.Add(this.right,new r.Mul("-1",this.left)),new o(n.sub(t))):new o(this.left,this.right.sub(t))},o.prototype.substituteExpression=function(t,n,i){var l;return t instanceof o&&(t=new r.Add(t.right,new r.Mul("-1",t.left))),this.left instanceof e.Variable&&this.left.label===n?(l=new r.Add(this.right,new r.Mul("-1",this.left)),new o(l.substituteExpression(t,n,i))):new o(this.left,this.right.substituteExpression(t,n,i))},o.prototype.toMathML=function(t,n,e,i){return null==n&&(n=!1),null==e&&(e=null),null==i&&(i=!1),this.right.toMathML(t,n,this.left,i)},o.prototype.toHTML=function(t,n,e,i){return null==n&&(n=!1),null==e&&(e=null),null==i&&(i=!1),this.right.toHTML(t,n,this.left,i)},o.prototype.toLaTeX=function(){return""+this.left.toLaTeX()+" = "+this.right.toLaTeX()},o.prototype.toString=function(){return""+this.left+" = "+this.right},o}()})}.call(this),function(){n.config({baseUrl:"./"}),e("coffeequate",["Equation","operators","terminals","parse"],function(t,n,e,i){return{Equation:t,tree:{operators:n,terminals:e},parse:i}})}.call(this),n(["coffeequate"]),n("coffeequate")});